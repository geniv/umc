' Gambas class file

tasks AS NEW String[]

PUBLIC SUB taskconfirm_Click()
  tasks.add(taskinput.Text)
  tasklist.Add(taskinput.Text)
  taskinput.Clear
  taskframe.Visible = FALSE
  tasknew.Enabled = TRUE
END

PUBLIC SUB Form_MouseDown()
  IF Mouse.Left THEN 
    taskframe.Visible = FALSE
    tasknew.Enabled = TRUE
  ENDIF 
END

PUBLIC SUB tasknew_Click()
  taskframe.Visible = TRUE
  tasknew.Enabled = FALSE
END

PUBLIC SUB Form_Close()
  DIM item AS String
  DIM index AS Integer
  'ulozeni task
  Settings["settings/taskcount"] = tasks.length
  FOR EACH item IN tasks
    Settings["settings/task" & index] = item
    INC index
  NEXT 

END

PUBLIC SUB Form_Open()
  DIM count, i AS Integer

  tasklist.Clear
  tasks.Clear
  count = Settings["settings/taskcount", 0]
  FOR i = 0 TO count - 1
    tasks.Add(Settings["settings/task" & i, ""])
  NEXT 
  rendertask()

END

PUBLIC SUB tasklist_KeyPress()
  IF tasklist.Index > -1 AND Key.Delete AND Message.Delete("Opravdu smazat tuto ulohu?", "Ano", "Ne") = 1 THEN 
    tasks.Delete(tasklist.Index)
    rendertask()
  ENDIF 
END

PRIVATE SUB rendertask()
  DIM item AS String
  tasklist.Clear
  FOR EACH item IN tasks
    tasklist.Add(item)
  NEXT
END


